---
import FullWidth from '@/layouts/FullWidth.astro';
import BlogCard from '@/components/BlogCard.astro';
import { getPostsByCollection } from '@/utils/posts';
import { PAGES } from '@/constants';

const { title, description } = PAGES.blog;

// Get posts organized by collection
const tutorials = await getPostsByCollection('tutorial');
const articles = await getPostsByCollection('article');
const reflections = await getPostsByCollection('reflection');
---

<FullWidth title={title} description={description}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

  <!-- Page Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
        Blog
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
        Thoughts on web development, programming, and technology.
        Sharing what I learn along the way.
      </p>
    </div>

    <!-- Reflections Section -->
    {reflections.length > 0 && (
      <section class="mb-16">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-8">
          Reflections
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {reflections.map((post) => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              pubDate={post.data.pubDate}
              url={`/posts/${post.slug}`}
              category={post.data.category}
              tags={post.data.tags}
              image={post.data.image}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Articles Section -->
    {articles.length > 0 && (
      <section class="mb-16">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-8">
          Articles
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {articles.map((post) => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              pubDate={post.data.pubDate}
              url={`/posts/${post.slug}`}
              category={post.data.category}
              tags={post.data.tags}
              image={post.data.image}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Tutorials Section -->
    {tutorials.length > 0 && (
      <section class="mb-16">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-8">
          Tutorials
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {tutorials.map((post) => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              pubDate={post.data.pubDate}
              url={`/posts/${post.slug}`}
              category={post.data.category}
              tags={post.data.tags}
              image={post.data.image}
            />
          ))}
        </div>
      </section>
    )}

    <!-- Empty State -->
    {tutorials.length === 0 && articles.length === 0 && reflections.length === 0 && (
      <div class="text-center py-12">
        <p class="text-gray-500 dark:text-gray-400 text-lg">
          No blog posts yet. Check back soon!
        </p>
      </div>
    )}
  </div>
</FullWidth>